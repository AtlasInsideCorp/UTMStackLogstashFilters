filter{
    if [type] == "Syslog" {
        mutate {
            add_field => {
                "dataType" => "firewall-fortinet"
            }
            rename => {
                "host" => "dataSource"
            }
            remove_field => ["date"]
            remove_field => ["time"]
        }
        grok{
            match => {
                "message" => 
                    "%{GREEDYDATA:timestamp} logid=%{NUMBER:logid} type=%{WORD:type} subtype=%{WORD:subtype} level=%{WORD:level} vd=%{WORD:vd} eventtime=%{NUMBER:eventtime} tz="+0400" srcip=%{IPV4:srcip} srcport=%{NUMBER:srcport} srcintfrole=%{WORD:srcintfrole} dstip=%{IPV4:srcip} dstport=%{NUMBER:dstport} dstintf=%{WORD:dstintf} dstintfrole=%{WORD:dstintfrole} sessionid=%{WORD:sessionid} proto=%{INT:proto} action=%{WORD:action} policyid=%{INT:policyid} policytype=%{WORD:policytype} service=%{WORD:service} %{GREEDYDATA:message_text}"
            }
        }
        if [timestamp] {
            date {
            match => ["timestamp", "MMM dd yyyy HH:mm:ss", "MMM d yyyy HH:mm:ss", "ISO8601"]
            }
        }
       if [logid]  {
           mutate {rename => ["logid",[logx][fortinet][logID]}
       }
       if [type]  {
        mutate {rename => ["type",[logx][fortinet][logType]}
        }
        if [subtype]  {
            mutate {rename => ["subtype",[logx][fortinet][logSubType]}
        }
        if [level]  {
            if [leve] == 0 {
                mutate {
                    add_field => {
                        "[logx][fortinet][severityLabel]" => "Emergency"
                    }
                } 
            }
            if [leve] == 1 {
                mutate {
                    add_field => {
                        "[logx][fortinet][severityLabel]" => "Alert"
                    }
                } 
            }
            if [leve] == 2 {
                mutate {
                    add_field => {
                        "[logx][fortinet][severityLabel]" => "Critical"
                    }
                } 
            }
            if [leve] == 3 {
                mutate {
                    add_field => {
                        "[logx][fortinet][severityLabel]" => "Error"
                    }
                } 
            }
            if [leve] == 4 {
                mutate {
                    add_field => {
                        "[logx][fortinet][severityLabel]" => "Warning"
                    }
                } 
            }
            if [leve] == 5 {
                mutate {
                    add_field => {
                        "[logx][fortinet][severityLabel]" => "Notification"
                    }
                } 
            }
            if [leve] == 5 {
                mutate {
                    add_field => {
                        "[logx][fortinet][severityLabel]" => "Information"
                    }
                } 
            }
        }
        if [vd]  {
            mutate {rename => ["vd",[logx][fortinet][virtualDomain]}
        }
        if [eventtime]  {
            mutate {rename => ["eventtime",[logx][fortinet][eventTime]}
        }
        if [srcip]  {
            mutate {rename => ["srcip",[logx][fortinet][sourceIP]}
        }
        if [srcport]  {
            mutate {rename => ["srcport",[logx][fortinet][sourcePort]}
        }
        if [srcintfrole]  {
            mutate {rename => ["srcintfrole",[logx][fortinet][sourceInterfaceName]}
        }
        if [dstip]  {
            mutate {rename => ["dstip",[logx][fortinet][destinationIP]}
        }
        if [dstport]  {
            mutate {rename => ["dstport",[logx][fortinet][destinationPort]}
        }
        if [dstintf]  {
            mutate {rename => ["dstintf",[logx][fortinet][destinationTrafic]}
        }
        if [dstintfrole]  {
            mutate {rename => ["dstintfrole",[logx][fortinet][destinationInterface]}
        }
        if [sessionid]  {
            mutate {rename => ["sessionid",[logx][fortinet][sessionID]}
        }
        if [proto]  {
            mutate {rename => ["proto",[logx][fortinet][protocolNumber]}
        }
        if [action]  {
            mutate {rename => ["action",[logx][fortinet][action]}
        }
        if [policyid]  {
            mutate {rename => ["policyid",[logx][fortinet][policyID]}
        }
        if [policytype]  {
            mutate {rename => ["policytype",[logx][fortinet][policyType]}
        }
        if [service]  {
            mutate {rename => ["service",[logx][fortinet][service]}
        }
    }
}